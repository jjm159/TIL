
# 내부 동작 확인

### `add` - 파일의 이름이 아니라 파일의 '내용'으로 구분한다.

index 디렉터리에는 object파일을 가리키는 인덱스 정보가 담겨 있다. objects 폴더에는 blob 파일이 있다. 이 파일은 git add '파일명' 으로 추가한 파일의 내용이 담겨있다.

여기서 중요한 것은 blob 파일은 원본 파일의 이름에 의해 구분되는 것이 아니라는 것이다. blob은 파일의 '내용'으로 구분된다. 이름이 다른 두 개의 파일이 같은 내용을 가지고 있다면 이 두 파일은 같은 blob을 가지게 된다. 

파일이 수정되고 staging되면 수정된 파일의 내용에 관한 blob파일이 생성된다. 그리고 수정된 파일의 blob파일에 대한 index는 이 새로운 blob파일을 가리키게 된다.


### `commit`

commit 내용이 담긴 파일도 객체로서 objects 디렉터리에서 관리된다. 이 파일에는 tree 파일을 가리키는 인덱스 정보가 담겨 있다. 

tree 파일에는 add된 수정 파일들의 blob 리스트가 담겨있다. tree 또한 객체로서 objects 디렉터리에 있다. 

여기서 commit을 한 번 더 하게되면 새로운 tree가 생성된다. 그리고 이 tree는 parent를 통해 이전 tree의 인덱스를 가리킨다.

tree는 각 버전의 정보를 가지고 있게 된다. 이는 마치 사진을 찍어두는 것과 같다고 하여 `스냅샷`이라고도 한다. tree 하나 당 한 장의 사진이라고 생각하면 된다. 

---

### 참고
[git add의 원리 - 지옥에서 온 Git](https://opentutorials.org/module/2676/15238)

[[GIT] 내부 동작 원리에 대한 이해](https://it-eldorado.tistory.com/4)