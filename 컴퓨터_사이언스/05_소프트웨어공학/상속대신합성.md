# 상속 보다는 합성 ()
- [[OOP] 코드의 재사용, 상속(Inheritance)보다 합성(Composition)을 사용해야 하는 이유](https://mangkyu.tistory.com/199)

## 상속(Inheritance)
- 상속은 상위 클래스에 중복 로직을 구현해두고 이를 물려받아 코드를 재사용하는 방법
- is-a 관계

## 합성(Composition) 이란
- 중복되는 로직들을 갖는 객체를 구현하고, 이 객체를 주입받아 중복 로직을 호출함으로써 퍼블릭 인터페이스를 재사용하는 방법
- 합성은 Has-a 관계

## 상속으로 코드를 재사용하는 것과 합성으로 퍼블릭 인터페이스를 재사용하는 것
- 객체의 내부는 공개되지 않고 인터페이스를 통해 코드를 재사용하기 때문에,
- 구현에 대한 의존성을 인터페이스에 대한 의존성으로 변경하여 결합도를 낮출 수 있음

## 상속(Inheritance)보다 합성(Composition)을 사용해야 하는 이유
- **상속의 단점 및 한계점**
    - 상속은 중복을 제거하기에 아주 좋은 객체지향 기술처럼 보이고, 그에 따라 상속을 무분별하게 남발하는 경우를 자주 볼 수 있다. 
    - 하지만 상속을 이용해야 하는 경우는 상당히 선택적이며, 상속이 갖는 단점은 상당히 치명적이기 때문에 상속보다는 합성을 이용할 것을 권장한다.
- 상속은 대표적으로 다음과 같은 단점을 가지고 있다.
    - 캡슐화가 깨지고 결합도가 높아짐
        - 상속을 이용하기 위해서는 부모 클래스의 내부 구조를 잘 알고 있어야 함
        - 왜냐하면 부모 클래스를 기반으로 자식 클래스의 코드를 구현해야 하기 때문
        - 자식 클래스에서 super를 이용해 부모 클래스의 메소드를 호출하는 상황이라면 부모 클래스의 구현은 자식 클래스에게 노출되어 캡슐화가 약해지고
        - 자식 클래스와 부모 클래스는 강하게 결합되어 부모 클래스를 변경할 때 자식 클래스도 함께 변경될 가능성이 높아진다.
    - 유연성 및 확장성이 떨어짐
        - 부모 클래스와 자식 클래스가 강하게 결합되므로!
        - 상속으로 구현하면 변경에 대한 범위가 상당히 커지므로 유연성과 확장성이 떨어짐
        - 만약 자식 클래스마다 메소드의 구현이 달라져야 하는 상황이라면 변경의 포인트가 자식 클랫들 만큼 추가되는 것
    - 다중상속에 의한 문제가 발생할 수 있음
    - 클래스 폭팔 문제가 발생할 수 있음
        - 상속을 남용하게 되면 필요 이상으로 많은 수의 클래스를 추가해야 하는 클래스 폭발(Class Explosion) 문제가 발생
        - 클래스 폭발 문제는 자식 클래스가 부모 클래스의 구현과 강하게 결합되도록 강요하는 상속의 근본적인 한계 때문에 발생
        - *컴파일 타임에 결정*된 자식 클래스와 부모 클래스 사이의 관계는 변경될 수 없기 때문에,
            - 자식 클래스와 부모 클래스의 다양한 조합이 필요한 상황에서 *유일한 해결 방법*은 조합의 수 만큼 새로운 클래스를 추가하는 것 뿐
        - 새로운 기능을 추가할 때뿐만 아니라 기능을 수정할 때에도 동일하게 발생
        - 여러 기능을 조합해야 하는 설계에 상속을 이용하면 모든 조합 가능한 경우 별로 클래스를 추가해야 한다.

## 합성 사용하기
- 상속은 컴파일 시점에 부모 클래스와 자식 클래스의 코드가 강하게 결합되는 반면에,
- 합성을 이용하면 구현을 효과적으로 캡슐화할 수 있다. 
- 또한 의존하는 객체를 교체하는 것이 비교적 쉬우므로 설계가 유연해진다. 
- 왜나하면 상속은 클래스를 통해 강하게 결합되지만 합성은 메세지를 통해 느슨하게 결합되기 때문이다. 
- 따라서 코드 재사용을 위해서는 상속보다 합성을 선호하는 것이 더 좋은 방법이다.

## 상속을 사용해야 하는 경우
- 상속의 용도는 크게 두 가지이다.
    - 타입 계층을 구현하는 것
    - 코드를 재사용하는 것
- 상속을 사용해야 하는 경우는 상당히 제약적
    - 부모와 자식 클래스가 Is-A 관계인 경우
        - 두 클래스가 어휘적으로 '타입 S는 타입 T이다'라고 표현할 수 있을 때
    - 행동 호환성이 만족하는 경우
        - 행동호환성이란 클라이언트의 입장에서 부모 클래스와 자식 클래스의 차이점을 몰라야 하며, 부모 클래스의 타입으로 자식 클래스를 사용해도 무방함을 의미