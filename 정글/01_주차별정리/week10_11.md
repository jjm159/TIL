# 10-11 주차
- 핀토스!!!
- 유저 프로그램
- 시스템 콜

---

## 학습 키워드 정리

#### User mode vs Kernel mode
- 운영체제는 제한된 하드웨어 리소스에 여러 개의 프로그램을 실행하기 위한 프로그램
- 여러 프로그램들은 하드웨어에 직접 접근하지 않고, 운영체제를 통해 접근
- 운영체제는 하드웨어 사용 요청이 들어오면, 프로그램끼리 우선 순위를 정해서 해당 요청을 처리
- 이렇게 하면 여러 프로그램이 하드웨어 자원을 사용하면서 발생할 수 있는 효율성, 보안 등의 문제들을 해결할 수 있음
    - 중앙 집권 체제!
- 이를 위해 cpu는 user mode와 kernel 모드를 구분하는 mode bit를 레지스터로 관리
- mode에 따라 실행 가능한 코드 제한
- 왜 cpu에 레지스터로 이 mode를 관리하는가?
    - os에서 관리할 경우, mode bit를 악의적으로 조작할 가능성 존재

#### User Stack
- 프로세스의 사용자 모드(user mode)에서 동작하는 코드가 사용하는 스택
- 커널 모드에서는 커널 스택이 사용된다.

#### System Call
- trap과 인터럽트 그리고 시스템 콜

#### Atomic Operation
- 실행 중간에 중단되지 않고, 분할될 수 없는 단일 작업
- 멀티 스레드 프로그래밍, 데이터베이스 트랜잭션, 운영체제 내부 동작에 사용
- 구현 방법
    - 하드웨어 
        - Test-and-Set, CAS
    - 소프트웨어
        - 락(뮤텍스), 세마포어

#### rax register
- RAX 레지스터는 x86-64 아키텍처에서 사용되는 64비트 범용 레지스터 중 하나
- 함수 호출 반환 값 변수로 사용
- 시스템 콜 호출 시에는 호출할 시스템 콜 번호를 지정

#### 32 bit OS vs 64 bit OS
- 한 번에 처리 가능한 데이터
    - 각각 32 비트, 64비트까지 한 번에 처리 가능
- 메모리 주소 범위
    - 32 bit는 최대 2^32, 약 4GB 메모리 접근 가능
    - 64 bit는 최대 2^64, 약 16EB 메모리 접근 가능
- 레지스터 크기
    - 각각 32 비트, 64비트

#### Interrupt
- cpu의 현재 실행 흐름과 관련 없는 이벤트 발생 시, cpu에 이를 알리고 현재 작업을 중단하고 해당 이벤트를 처리하도록 하는 메커니즘
- 하드웨어와 소프트웨어 모두 인터럽트 요청 가능
- 처리 과정
    - Interrupt Request(IRQ)를 보냄
    - 현재 작업 내용(PC, 레지스터 등)을 저장
    - 인터럽트 핸들러 실행
        - Interrupt Vector Table(IVT) 참조
            - 인터럽트 번호로 참조
        - Interrupt Service Routine(ISR) 실행
    - 작업 복구, 재개
        - 핸들러 실행 종료 후 이전에 저장한 상태 복원
        - 중단되었던 작업 재개
- 인터럽트 종류 
    - 하드웨어 
        - 키보드, 타이머, I/O 장치(네트워크 패킷 수신, 데이터 전송 완료)
    - 소프트웨어 (트랩)
        - 시스템 콜 - user program이 커널에 요청
        - 예외 - 0으로 나누는

#### Segmentation Fault
- 프로그램이 허용되지 않은 메모리 영역에 접근하려고 할 때 os가 발생시키는 오류
- 메모리 보호 메커니즘

---

## 퀴즈 정리 

#### 커널 모드에서 실행될 수 있는 작업의 예를 들고, 이러한 작업들이 사용자 모드에서 실행되지 않는 이유를 설명
- 공유 자원 관리는 운영 체제의 중요한 기능 중 하나로, 주로 커널 모드에서 실행됩니다.
예를 들어, 파일 시스템, 메모리, 프린터 등과 같은 자원은 여러 프로세스에 의해 동시에
요청될 수 있으며, 이에 대한 접근과 사용을 적절히 관리하는 것이 필수적입니다. 커널
모드에서는 이러한 자원들에 대한 접근을 제어하고, 충돌이나 데이터 손상을 방지하는
역할을 합니다.
- 사용자 모드에서는 이러한 공유 자원의 직접 관리를 수행하지 않습니다. 이는 여러 사용자
또는 프로세스가 자원에 직접 접근할 경우 데이터의 일관성과 안정성이 위협받을 수 있기
때문입니다.

#### 운영 체제에서 컨텍스트 스위칭이 발생하는 과정에서 어떤 정보가 저장되고 복원되는지 설명
- 컨텍스트 스위칭 과정에서 운영 체제는 현재 프로세스의 상태(컨텍스트)를 저장하고,
다음에 실행할 프로세스의 저장된 상태를 복원합니다.
저장되는 정보에는 프로세스의 프로그램 카운터, 레지스터 상태, 메모리 관리 정보, 열린
파일 목록 등이 포함됩니다.

#### fsync() 함수의 작동 원리를 설명하고, 이 함수가 파일 시스템에서 어떤 역할을 하는지 서술. 또한, fsync()를 사용할 때 고려해야 할 성능상의 영향에 대해서도 설명
- fsync() 함수는 열려 있는 파일 디스크립터와 관련된 모든 수정된 데이터를 디스크에
동기화합니다. 이는 파일의 쓰기 작업이 메모리에만 저장되는 것이 아니라, 실제 저장
매체에도 반영되도록 보장하는 역할을 합니다. fsync()의 중요한 역할 중 하나는 시스템이
예기치 않게 중단되더라도 데이터의 무결성을 보장하는 것입니다.
- fsync()를 사용할 때의 주요 성능상의 영향으로는 디스크 I/O 작업이 증가하여 시스템의
전반적인 성능 저하가 발생할 수 있다는 점을 고려해야 합니다. 특히, 빈번한 fsync()
호출은 디스크의 작업 부하를 증가시키고, 결과적으로 시스템의 반응 속도를 늦출 수
있습니다.

---