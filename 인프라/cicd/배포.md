# 소프트웨어 시스템의 배포

## 소프트웨어 시스템에서 고려해야할 관심사
- Reliability - 신뢰성
    - 시스템의 안정성과 장애 복구 능력 보장
- Scalability - 확장성
    - 성능을 저하하지 않고 시스템의 늘어난 수요를 처리할 수 있게 함
- Maintainability - 유지보수성
    - 시스템은 장기적으로 안정적으로 운영되고, 새로운 기능 추가 시 쉽게 관리되도록 보장

#### Reliability 신뢰성 - 서비스 얼마나 지속되냐!!
- What?
    - 장애가 나도 복구가 되고, `서비스가 지속되는 능력`
    - 비즈니스 중단을 방지
- 신뢰성 보장 방법
    - 장애 대응 계획 Disaster Recovery Plan
        - 대응 프로세스 미리 마련
        - 실시간 모니터링 + 알림 시스템
    - 무중단 운영 High Availability
        - 자둥 데이터 센터 구성 
            - `멀티리전`, `멀티 AZ(가용 영역)` 아키텍처
        - 로드 밸런싱
            - 트래픽을 여러 서버에 분산
        - Active-Active 및 Active-Passive
            - `Active-Active`
                - 모든 서버가 동시에 동작, 하나가 장애 나도 서비스가 지속되도록 함
            - `Active-Passive`
                - 하나의 서버가 동작하고, 장애시 대기 상태의 서버가 활성화되어 서비스 지속
    - Failover 시스템
        - 자동 Failover 
            - 장애 발생시 자동으로 백업 시스템 활성화, 중단 없이 운영 지속
            - 이를 `Failover 시스템` 이라고 함
            - 대기중인 백업 시스템이 있고, 장애시 빠르게 백업 시스템으로 전환하는 것!
            - 예시
                - AWS RDS: 다중 가용 영역에 걸쳐 자동으로 데이터베이스 복제, 자동으로 백업 데이터베이스로 전환하는 failover 기능 제공
    - 데이터 복제 및 백업 전략
        - 다중 리전 데이터 복제
            - 데이터를 여러 리전에 걸쳐 복제
            - 특정 리전 장애 시 데이터 손실 없이 다른 리전에서 복구
        - 주기적인 백업 및 복구 테스트
            - 백업이 잘되는지 복구는 잘되는지 주기적으로 테스트 필요
    - 자동 복구 Self-Healing System
        - 자동 장애 감지 및 복구
        - 인스턴스 다운시 새 인스턴스 자동 생성, 네트워크 장애시 대체 경로 탐색
        - 차이점
            - failover는 서버의 전환을 중점
            - 데이터 복제 및 백업은 데이터 유실 방지에 중점
            - 자동 복구는 오류 감지 및 자동 복구에 중점
    - 모니터링 및 장애 감지
        - 실시간 모니터링
        - 프로메테우스 같은 메트릭 기반 모니터링 도구
            - 메트릭 지속적으로 수집, 일정 기준 도달 시 자동으로 알림

#### Scalability 확장성 -> 성능과 관련된거임!!!
- What?
    - 트래픽 증가, 자원 요구 증가할 때 `성능 저하 없이` 이를 처리할 수 있는 능력
    - 늘어나는 부하를 처리할 수 있도록 설계!
    - 클라우드에서는 필수
- 중요성
    - 비즈니스 성장 대응
        - 비즈니스가 성장함에 따라 더 많은 사용자가 접근하게되고 확장성 있는 시스템은 그럴 때에도 성능 저하 없이 운영 가능
    - 비용 효율성
        - 필요할 때만 자원을 늘려서 비용을 절감할 수 있음
    - 안정적 사용자 경험
        - 트래픽이 증가해도 사용자 경험에 문제 없이 운영
- __확장성의 `종류`__
    - 수직 확장 - Vertical Scaling
        - 서버나 시스템 자원을 업그레이드
        - CPU, Memory, 스토리지 등의 하드웨어 성능 업그레이드
        - 물리적 자원의 한계에 도달하면 더 이상 성능을 높일 수 없음
        - 비용이 기하급수적으로 증가
        - 예시
            - 은행 시스템은 보안 때문에 서버를 늘리는 게 제한적
    - 수평 확장 - Horizontal Scaling
        - 여러 대의 서버를 추가
        - 트래픽을 분산하여 처리
        - 여러 인스턴스를 활용하여 성능을 높이는 방식
        - 물리적 제한 없이 확장 가능
        - 쉽게 성능 향상 가능
        - 분산된 환경에 의한 복잡한 인프라 설정과 관리
        - 데이터 일관성을 위한 추가 설계 필요
    - 하이브리드 확장
        - 둘 다
- __확장성을 `보장하는 방법`__
    - `Auto Scaling` 오토스케일링
        - 클라우드 환경에서 인스턴스를 자동으로 부하에 맞게 추가하거나 축소하는 기능
        - 비용 효율성 극대화
        - AWS의 Auto Scaling
    - `Load Balancing` 로드밸런싱
        - 트래픽을 분산
        - 시스템 가용성을 높이는 방법
            - __가용성?__ : 시스템을 정상적으로 사용 가능한 정도. 정상작동시간/전체시간
        - 로드 밸런서 설정 복잡, 네트워크 레벨의 문제 추가적으로 고려
    - `Database Sharding` 샤딩
        - 여러 개의 작은 데이터베이스로 분할
        - 데이터베이스의 성능 한계를 넘어서기 위한 수평 확장 방법
        - __성능을 크게 향상 시킬 수 있음__
        - 데이터 일관성 유지하는 방법이 복잡. 샤딩된 데이터베이스 간 동기화 이슈 발생 가능
        - 유뷰브는 동영상 데이터 처리를 위해 데이터베이스 샤딩 도입
    - `Cache System` 캐시
        - 자주 조회되는 데이터를 메모리에 저장하여 빠르게 응답
        - 캐시 무효화 전략 필요
        - Twitter의 Redis 캐시 시스템 참고!
- __확장성 `테스트 방법`__
    - 부하 테스트 - `Load Testing`
        - 예상 트래픽 수준에서 얼마나 안정적으로 동작하는지 테스트
        - `Apache JMeter`, Gatling, k6 등으로 다양한 시나리오에서 시스템 부하 테스트
    - 스트레스 테스트 - `Stress Testing`
        - 정상적인 운영 범위를 초과하는 부하를 가해 언제 성능이 저하되는지, 언제 장애가 나는지 확인
        - Locust, `Artillery` 등으로 최대 처리 용량을 초과하는 부하를 시뮬레이션
    - 스파이크 테스트 - `Spike Testing`
        - 짧은 시간 내에 급격히 증가하는 트래픽에 시스템이 어떻게 반응하는지 확인
        - 갑작스러운 트패픽 증가에 시스템이 견딜 수 있는지 검증

#### Maintainability 유지보수성
- What?
    - 새로운 기능을 추가하거나 버그 수정시 얼마나 쉽게 관리되고 수정될 수 있는지
    - 유지보수성이 좋으면 개발 속도를 높이고, 시스템 운영 비용을 줄일 수 있음
    - 코드 가독성, 시스템의 모듈화, 자동화된 테스트 등이 유지보수성을 높여줌
- 유지보수성의 중요성
    - 장기적 비용 절감
    - 개발 생산성 향상
    - 기능 확장 용이
    - 신속한 문제 해결
- 유지보수성을 보장하는 방법
    - `모듈화` - Modularization
        - 모듈이란 독립성과 은닉성을 만족하는 코드 묶음
        - 독립성 - 개별적으로 수정, 교체가 가능
        - 각 모듈이 독립적으로 수정되어도 다른 모듈에 영향 X -> 파급 효과 줄임
        - MSA - 각 기능을 독립된 서비스로 나누어 개발, 배포. 유지보수성이 크게 향상
    - `코드 품질 관리`
        - 코드가 가독성이 좋아야 하고, 스타일이 일관되어야 함
        - 그래야 나중에 다시 보고 이해하는 시간이 줄어들고, 수정 시간이 줄어든다.
    - `문서화 및 주석` - Documentation & Comments
        - 새루운 개발자가 쉽게 시스템을 이해하고 유지보수 할 수 있게 함
    - `자동화된 테스트` - Automated Testing
        - 정상적으로 동작하는지 자동으로 검증
        - 자동으로 테스트 해야 유지보수성이 높아짐
        - 수동 테스트는 모두 비용이고, 실수 유발 가능성 있음
    - `CI/CD 파이프라인` - Continuous Integration/Continuous Deployment
        - 코드 변경 시 자동 테스트, 배포까지 자동화
        - 더 빠르고 자주 추가 배포 가능
    - `기술 부채 관리` - Managing Technical Debt
        - 나쁜 설계로 발생하는 유지보수 비용을 줄여야 함
    - `버전 관리` - Version Control
        - 버전 관리를 통해 쉽게 롤백, 특정 시점에서 발생한 문제 해결이 가능

---

## 배포
- What?
    - 단순히 소프트웨어를 사용 가능한 상태로 만드는 게 아니라, 시스템의 안정성, 성능, 확장성을 보장해야 하는 중요한 절차
    - 배포 과정에서 적절한 계획과 검증이 이뤄지지 않으면 서비스 중단, 데이터 손실, 성능 저하 등의 문제 가능
    - 배포는 시스템의 신뢰성, 확장성, 유지보수성을 고려한 설계와 밀접하게 연관
- 배포와 신뢰성
    - 배포는 신뢰성 보장의 핵심적 역할
    - `배포 프로세스`에서 `장애가 없도록` 해야하고, `신속 복구 전략` 필요
- 배포와 확장성
    - 배포는 확장성 보장을 위한 필수 절차
    - 배포 후 트래픽이 급증할 수 있기 때문에 시스템이 이를 수용할 수 있도록 `확장 가능한 구조로 배포`해야함
- 배포와 유지보수성
    - 쉽게 배포 못하면 새로운 기능을 추가하거나 문제 수정 시 비용이 증가 (시간)
    - 수정 및 업데이트가 용이하도록 설계해야 함
    - 쉽게 배포할 수 있어야 함