# 학습 내용
- 가상메모리
- 메모리 할당기
- 이더넷

## 학습 정리

### 가상메모리, 페이징

#### What?
- "메모리를 추상화"
- 프로그램이 메모리를 온전히 사용한다고 착각
- 한정적인 자원을 더 크게 쓰기 위해서?!

#### 왜 가상화 하지?
- 운영체제가 메모리를 더 쉽게 관리하기 위해서
- 일정한 포맷으로 주소를 가상화함

#### 장점이 뭐지?
- 링킹 단순화
    - 가상메모리를 통해 메모리 구조를 일관적으로 통일시킬 수 있어 링킹(목적파일끼리 결합) 과정이 단순해짐
- 로딩 단순화
    - 운영체제가 정해놓은 가상메모리 포맷에 맞춰 쉽게 로딩 가능 
- 공유 단순화
    - 다른 프로세스에서 동일한 메모리를 사용할 때 피지컬 메모리에 있는 실제 데이터를 공유
- 메모리 할당 단순화
    - cpu가 메모리를 바라볼 때 연속적으로 바라보고, 실제 메모리 할당은 페이징 단위로

#### 여담
- 내가 printf한 주소가 사실 짭이었다니..?

#### 페이징
- 외부 단편화를 해결하기 위해 사용되는 기술

#### 세그멘테이션 vs 페이징
- 초기에 연속 메모리 할당 -> 메모리 침범 문제
- 세그멘테이션 도입 -> 외부 단편화 문제
- 페이징 도입 -> 내부 단편화 문제 있지만 젤 좋음

### 동적메모리할당 (힙, sbrk, malloc, free)
- 힙 = 좋은 친구(엄마가 친하게 지내랬음)
    - 주의사항
        - `누수 조심하세요..`
        - `느려요...`
- sbrk
    - 힙의 꼭대기를 가리키는 포인터
    - heap overflow
        - 프로그램이 힙에 할당된 메모리 범위를 넘어서 데이터를 쓰는 행위
    - Segmentation fault
        - 메모리 보호를 위반하여 잘못된 메모리 주소에 접근할 때 발생하는 오류
- malloc
    - 메모리 동적 할당
        - 동적 할당의 `원조`
- free
    - 동적 메모리 반환

### 메모리 단편화
- 빈공간이 있는데 못쓰는 상황

### 메모리 할당 정책 (first fit, next fit, best fit)
- first fit 
    - 처음 발견한 빈 공간 반환
- next fit
    - 직전에 할당된 메모리로부터 처음 발견한 빈 공간 반환
- best fit
    - 프로세스가 원하는 만큼의 할당 가능한 빈 공간 중 가장 작은 공간 반환

### implicit free list, explicit free list
- 묵시적 가용 리스트
    - 빈 공간 기록 X
- 명시적 가용 리스트
    - 빈 공간 기록 O
    - 빈 공간만 탐색 -> 시간 절약
    - 빈 공간 기록 공간 필요 -> 공간 추가

### demand-zero memory
- 실제 해당 페이지를 사용할 때 물리 메모리에 적재
- page status
    - unallocated
        - 디스크에만 있는 페이지
    - cached
        - 실제 물리 메모리에 적재된 페이지
    - uncached
        - 물리 메모리에는 적재되지 않고, PT에만 적재된 메모리

- [참고](https://velog.io/@orcasuit/demand-zero-memory)

### 시스템콜
- 하드웨어 기능을 사용할 수 있도록 운영체제가 추상화 한 함수들

### DMA (Direct Memory Access)
- CPU 개입 없이 직접 메모리에 접근
- 왜 DMA 기법이 필요한가?
    - CPU가 주변 장치와 데이터를 주고 받는 방식은 효율이 떨어졌기 때문.
- 동작방식
    1. I/O 장치가 DMA 컨트롤러한테 요청 보냄
    2. DMA 컨트롤러가 CPU와는 독립적으로 메모리에 접근할 수 있는 권한 얻음
    3. 데이터 전송
    4. 전송 후 알림: 인터럽트 발생

### 이더넷
- 데이터레이어와 물리레이어 사이의 통신 기술들의 표준 규격
- [표준 IEEE 802.3](https://www.ieee802.org/3/)
- [쉽게 설명](https://brunch.co.kr/@swimjiy/49)
![image](https://hackmd.io/_uploads/Syb2D_7xyg.png)

### CSAPP 6 메모리 계층구조
- 왜 계층 구조를 만들까?
    - 비용을 줄이기 위해 
    - 더 자주 사용하는 데이터는 비싼 메모리에 적재하고, 그렇지 않은 데이터는 더 값싼 메모리에 적재
- 캐시 메모리에 메인 메모리 데이터를 매핑하는 방법
    - 직접 매핑 캐시
    - 연관 매핑 캐시 
    - 직접-연관 매핑 캐시

## 퀴즈